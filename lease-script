#!rsc
# RouterOS script: lease-script
# Copyright (c) 2013-2019 Christian Hesse <mail@eworm.de>
#
# run scripts on DHCP lease
# ( / ip dhcp-server set lease-script=lease-script [ find ] )

:local Scripts {
  "dhcp-to-dns";
  "collect-wireless-mac.local";
  "dhcp-lease-comment.local";
  "collect-wireless-mac.capsman";
  "dhcp-lease-comment.capsman"
}

# delay a second to give time to update the lease table
:delay 1s;

:foreach Script in=$Scripts do={
  :if ([ / system script print count-only where name=$Script ] > 0) do={
    :log debug ("Running script from lease-script: " . $Script);
    / system script run $Script;
  }
}
